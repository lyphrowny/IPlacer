# Постановка задачи

На вход подается изображение, на котором расположены заранее известные предметы и начерченный на белом листе бумаги многоугольник. 

Необходимо расположить максимальное количество изображенных предметов в начерченный многоугольник. Если максимальное количество достигается с различным набором предметов, следует выбрать тот набор, на котором достигается наибольшая площадь покрытия начерченного многоугольника.

На выходе возвращается набор вмещенных предметов и отношение непокрытой площади многоугольника к площади всего многоугольника.

---

# Требования к входным данным

## Общие

 * Тень [почти] отсутствует
 * Высота съемки 40-60см над горизонтальной поверхностью
 * Камера отклоняется от нормали к горизонтальной поверхности не более чем на 5°
 * Все предметы полностью помещаются на изображении
 * Формат: .jpg
 * Разрешение: 4000x3000


## Изображения предметов

 * Расположен на белом листе A4 в центре
 * Лист лежит на горизонтальной поверхности, фон которой близок к белому
 * Лист помещается на изображении с краями
 * Предмет на листе единственен
 * Границы предмета четко различимы на белом листе A4


## Изображения предметов с многоугольником

 * Многоугольник замкнутый, может самопересекаться, невырожденный, > 2 вершин
 * Начерчен темным цветом на белой бумаге A5, толщина линии > 1мм в естественной плоскости
 * Многоугольник на листе единственен

<!-- -->

 * Предметы расположены так, чтобы между ними был виден фон
 * Предметы могут находится внутри, но не на другом предмете
 * Может быть несколько одинаковых предметов на одном изображении



 * Лист с многоугольником и предметы должны не пересекаться

---

# План решения задачи

 1. Разделить лист с многоугольников и объекты

    Пока возможно деление входящего изображения на левое (с многоугольником) и на правое (с объектами), ибо входные данные позволяют так разделить. Однако, требования по такому расположению многоугольника и объектов отсутствуют: нужно улучшение


 2. Выделить многоугольник и создать для него маску

    * Для выполнения этой задачи должен подойти фильтр Кэнни: выделить границы, заполнить внутренность (растровый алгоритм заливки, например)
    * Посчитать площадь многоугольника (для каждой из частей в случае самопересечения)


 3. Выделить каждый объект из представленных на фото

    Выделить границы фильтром Кэнни (найти граничные точки?), построить маски объектов


 4. Классифицировать выделенные объекты

    Попробовать совместить маски представленного объекта с объектом-образцом, выбрать наиболее подходящую (например, по разнице площадей)

    Возможные проблемы:

     * площади объектов-образцов близки -> неоднозначные результаты
     * площадь маски выделенного объекта искажена из-за артефактов фото -> неоднозначные результаты

    Скорее всего, нужно выделять иные особенности объектов


 5. Расположить выделенные объекты в многоугольнике

    * Сравнить площади: отбросить объекты, площадь которых больше площади многоугольника
    * Вписать выделенные объекты в минимальный прямоугольник, по размерностям которого сделать предположение о помещаемости в многоугольник, откалибровать предположение, используя площадь выделенного объекта
    * Расположить выделенный объект внутри многоугольника. Используя вращения и переносы расположить так, чтобы максимизировать площади многоугольника по не более чем 2-м сторонам выделенного объекта (расположить так, чтобы уменьшить фрагментацию оставшегося многоугольника). Повторить для всех выделенных объектов.


 6. Сформировать ответ

    Из всех расположений выбрать максимальное по количеству вмещенных объектов. Если таких наборов несколько, выбрать тот, площадь покрытия которого наибольшая.

---
# Входные данные

## Предметы

 * Губка

    ![Губка](imgs/items/spounge.jpg)

 * Шпатель

    ![Шпатель](imgs/items/spatula.jpg)

 * Пуговица

    ![Пуговица](imgs/items/button.jpg)

 * Колпачок от ручки

    ![Колпачок от ручки](imgs/items/cap.jpg)

 * Пластилиновый шарик

    ![Пластилиновый шарик](imgs/items/clay.jpg)

 * Шестиугольник

    ![Шестиугольник](imgs/items/hexagon.jpg)

 * Симка

    ![Симка](imgs/items/sim.jpg)

 * Резинка

    ![Резинка](imgs/items/rubber_band.jpg)


 * Флешка

    ![Флешка](imgs/items/flash_drive.jpg)


 * Колесо

    ![Колесо](imgs/items/wheel.jpg)

 * Фон

    ![Фон](imgs/items/bg.jpg)

## Примеры

 * 0 предметов

    ![0 предметов](imgs/input_data/a/a0.jpg)

 * 1 помещающийся предмет

    ![1 помещающийся предмет](imgs/input_data/a/a1.jpg)

 * 1 непомещающийся предмет

    ![1 непомещающийся предмет](imgs/input_data/a/a3.jpg)

 * 1 помещающийся из 2 предмет, выбрать максимальную площадь покрытия

    ![1 помещающийся из 2 предмет, выбрать максимальную площадь покрытия](imgs/input_data/a/a5.jpg)

 * 3 помещающихся предмета, вложенность предметов

    ![3 помещающихся предмета, вложенность предметов](imgs/input_data/c/c3.jpg)

 * 1 непомещающийся предмет, самопересеченность многоугольника

    ![1 непомещающийся предмет, самопересеченность многоугольника](imgs/input_data/g/g0.jpg)

 * 8 помещающихся предметов, самопересеченность многоугольника

    ![1 непомещающийся предмет, самопересеченность многоугольника](imgs/input_data/g/g2.jpg)


Другие тестовые данные можно найти в [imgs/input_data](imgs/input_data).

Разметка данных находится в [imgs/input_data/desc.pydict](imgs/input_data/desc.pydict). Формат разметки указан в комментариях (#) в самом файле.
